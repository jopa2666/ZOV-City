hg = hg or {}

hg.FootSteps = {
    dirt = {
        "zcitysnd/player/footsteps/dirt1.wav",
        "zcitysnd/player/footsteps/dirt10.wav",
        "zcitysnd/player/footsteps/dirt2.wav",
        "zcitysnd/player/footsteps/dirt3.wav",
        "zcitysnd/player/footsteps/dirt4.wav",
        "zcitysnd/player/footsteps/dirt5.wav",
        "zcitysnd/player/footsteps/dirt6.wav",
        "zcitysnd/player/footsteps/dirt7.wav",
        "zcitysnd/player/footsteps/dirt8.wav",
        "zcitysnd/player/footsteps/dirt11.wav"
    },
    grass = {
        "zcitysnd/player/footsteps/grass1.wav",
        "zcitysnd/player/footsteps/grass2.wav",
        "zcitysnd/player/footsteps/grass3.wav",
        "zcitysnd/player/footsteps/grass4.wav",
        "zcitysnd/player/footsteps/grass5.wav",
        "zcitysnd/player/footsteps/grass6.wav",
        "zcitysnd/player/footsteps/grass7.wav",
        "zcitysnd/player/footsteps/grass8.wav",
        "zcitysnd/player/footsteps/grass9.wav",
        "zcitysnd/player/footsteps/grass10.wav",
        "zcitysnd/player/footsteps/grass11.wav"
    },
    paper = {
        "zcitysnd/player/footsteps/grass1.wav",
        "zcitysnd/player/footsteps/grass2.wav",
        "zcitysnd/player/footsteps/grass3.wav",
        "zcitysnd/player/footsteps/grass4.wav",
        "zcitysnd/player/footsteps/grass5.wav",
        "zcitysnd/player/footsteps/grass6.wav",
        "zcitysnd/player/footsteps/grass7.wav",
        "zcitysnd/player/footsteps/grass8.wav",
        "zcitysnd/player/footsteps/grass9.wav",
        "zcitysnd/player/footsteps/grass10.wav",
        "zcitysnd/player/footsteps/grass11.wav"
    },
    metal = {
        "zcitysnd/player/footsteps/metal1.wav",
        "zcitysnd/player/footsteps/metal2.wav",
        "zcitysnd/player/footsteps/metal3.wav",
        "zcitysnd/player/footsteps/metal4.wav",
        "zcitysnd/player/footsteps/metal5.wav",
        "zcitysnd/player/footsteps/metal6.wav",
        "zcitysnd/player/footsteps/metal7.wav",
        "zcitysnd/player/footsteps/metal8.wav",
        "zcitysnd/player/footsteps/metal9.wav"
    },
    metalvehicle = {
        "zcitysnd/player/footsteps/metal1.wav",
        "zcitysnd/player/footsteps/metal2.wav",
        "zcitysnd/player/footsteps/metal3.wav",
        "zcitysnd/player/footsteps/metal4.wav",
        "zcitysnd/player/footsteps/metal5.wav",
        "zcitysnd/player/footsteps/metal6.wav",
        "zcitysnd/player/footsteps/metal7.wav",
        "zcitysnd/player/footsteps/metal8.wav",
        "zcitysnd/player/footsteps/metal9.wav"
    },
    metalvent = {
        "zcitysnd/player/footsteps/duct1.wav",
        "zcitysnd/player/footsteps/duct2.wav",
        "zcitysnd/player/footsteps/duct3.wav",
        "zcitysnd/player/footsteps/duct4.wav",
        "zcitysnd/player/footsteps/duct5.wav",
        "zcitysnd/player/footsteps/duct6.wav",
        "zcitysnd/player/footsteps/duct7.wav",
        "zcitysnd/player/footsteps/duct8.wav",
        "zcitysnd/player/footsteps/duct9.wav",
        "zcitysnd/player/footsteps/duct10.wav"
    },
    metalpanel = {
        "zcitysnd/player/footsteps/metal1.wav",
        "zcitysnd/player/footsteps/metal2.wav",
        "zcitysnd/player/footsteps/metal3.wav",
        "zcitysnd/player/footsteps/metal4.wav",
        "zcitysnd/player/footsteps/metal5.wav",
        "zcitysnd/player/footsteps/metal6.wav",
        "zcitysnd/player/footsteps/metal7.wav",
        "zcitysnd/player/footsteps/metal8.wav",
        "zcitysnd/player/footsteps/metal9.wav"
    },
    tile = {
        "zcitysnd/player/footsteps/tile1.wav",
        "zcitysnd/player/footsteps/tile2.wav",
        "zcitysnd/player/footsteps/tile3.wav",
        "zcitysnd/player/footsteps/tile4.wav",
        "zcitysnd/player/footsteps/tile5.wav",
        "zcitysnd/player/footsteps/tile6.wav",
        "zcitysnd/player/footsteps/tile7.wav",
        "zcitysnd/player/footsteps/tile8.wav",
        "zcitysnd/player/footsteps/tile9.wav",
        "zcitysnd/player/footsteps/tile10.wav",
        "zcitysnd/player/footsteps/tile11.wav"
    },
    chainlink = {
        "zcitysnd/player/footsteps/chainlink1.wav",
        "zcitysnd/player/footsteps/chainlink2.wav",
        "zcitysnd/player/footsteps/chainlink3.wav",
        "zcitysnd/player/footsteps/chainlink4.wav",
        "zcitysnd/player/footsteps/chainlink5.wav",
        "zcitysnd/player/footsteps/chainlink6.wav",
        "zcitysnd/player/footsteps/chainlink7.wav",
        "zcitysnd/player/footsteps/chainlink8.wav",
        "zcitysnd/player/footsteps/chainlink9.wav",
        "zcitysnd/player/footsteps/chainlink10.wav",
        "zcitysnd/player/footsteps/chainlink11.wav"
    },
    sand = {
        "zcitysnd/player/footsteps/sand1.wav",
        "zcitysnd/player/footsteps/sand2.wav",
        "zcitysnd/player/footsteps/sand3.wav",
        "zcitysnd/player/footsteps/sand4.wav",
        "zcitysnd/player/footsteps/sand5.wav",
        "zcitysnd/player/footsteps/sand6.wav",
        "zcitysnd/player/footsteps/sand7.wav",
        "zcitysnd/player/footsteps/sand8.wav",
        "zcitysnd/player/footsteps/sand9.wav",
        "zcitysnd/player/footsteps/sand10.wav",
        "zcitysnd/player/footsteps/sand11.wav"
    },
    gravel = {
        "zcitysnd/player/footsteps/gravel1.wav",
        "zcitysnd/player/footsteps/gravel2.wav",
        "zcitysnd/player/footsteps/gravel3.wav",
        "zcitysnd/player/footsteps/gravel4.wav",
        "zcitysnd/player/footsteps/gravel5.wav",
        "zcitysnd/player/footsteps/gravel6.wav",
        "zcitysnd/player/footsteps/gravel7.wav",
        "zcitysnd/player/footsteps/gravel8.wav",
        "zcitysnd/player/footsteps/gravel9.wav",
        "zcitysnd/player/footsteps/gravel10.wav"
    },
    glass = {
        "zcitysnd/player/footsteps/glass1.wav",
        "zcitysnd/player/footsteps/glass2.wav",
        "zcitysnd/player/footsteps/glass3.wav",
        "zcitysnd/player/footsteps/glass4.wav",
        "zcitysnd/player/footsteps/glass5.wav",
        "zcitysnd/player/footsteps/glass6.wav",
        "zcitysnd/player/footsteps/glass7.wav",
        "zcitysnd/player/footsteps/glass8.wav",
        "zcitysnd/player/footsteps/glass9.wav",
        "zcitysnd/player/footsteps/glass10.wav"
    },
    rubber = {
        "homigrad/player/footsteps/new/rubber_03.wav",
        "homigrad/player/footsteps/new/rubber_04.wav",
        "homigrad/player/footsteps/new/rubber_05.wav",
        "homigrad/player/footsteps/new/rubber_06.wav",
        "homigrad/player/footsteps/new/rubber_07.wav",
        "homigrad/player/footsteps/new/rubber_08.wav",
        "homigrad/player/footsteps/new/rubber_11.wav",
        "homigrad/player/footsteps/new/rubber_12.wav"
    },
    mud = {
        "zcitysnd/player/footsteps/mud1.wav",
        "zcitysnd/player/footsteps/mud2.wav",
        "zcitysnd/player/footsteps/mud3.wav",
        "zcitysnd/player/footsteps/mud4.wav",
        "zcitysnd/player/footsteps/mud5.wav",
        "zcitysnd/player/footsteps/mud6.wav",
        "zcitysnd/player/footsteps/mud7.wav",
        "zcitysnd/player/footsteps/mud8.wav",
        "zcitysnd/player/footsteps/mud9.wav"
    },
    snow = {
        "homigrad/player/footsteps/new/snow_01.wav",
        "homigrad/player/footsteps/new/snow_02.wav",
        "homigrad/player/footsteps/new/snow_03.wav",
        "homigrad/player/footsteps/new/snow_04.wav",
        "homigrad/player/footsteps/new/snow_05.wav",
        "homigrad/player/footsteps/new/snow_06.wav",
        "homigrad/player/footsteps/new/snow_07.wav",
        "homigrad/player/footsteps/new/snow_08.wav",
        "homigrad/player/footsteps/new/snow_09.wav",
        "homigrad/player/footsteps/new/snow_10.wav",
        "homigrad/player/footsteps/new/snow_11.wav",
        "homigrad/player/footsteps/new/snow_12.wav"
    },
    wood = {
        "zcitysnd/player/footsteps/wood1.wav",
        "zcitysnd/player/footsteps/wood2.wav",
        "zcitysnd/player/footsteps/wood3.wav",
        "zcitysnd/player/footsteps/wood4.wav",
        "zcitysnd/player/footsteps/wood5.wav",
        "zcitysnd/player/footsteps/wood6.wav",
        "zcitysnd/player/footsteps/wood7.wav",
        "zcitysnd/player/footsteps/wood8.wav",
        "zcitysnd/player/footsteps/wood9.wav",
        "zcitysnd/player/footsteps/wood10.wav",
        "zcitysnd/player/footsteps/wood11.wav"
    },
    wood_crate = {
        "zcitysnd/player/footsteps/wood1.wav",
        "zcitysnd/player/footsteps/wood2.wav",
        "zcitysnd/player/footsteps/wood3.wav",
        "zcitysnd/player/footsteps/wood4.wav",
        "zcitysnd/player/footsteps/wood5.wav",
        "zcitysnd/player/footsteps/wood6.wav",
        "zcitysnd/player/footsteps/wood7.wav",
        "zcitysnd/player/footsteps/wood8.wav",
        "zcitysnd/player/footsteps/wood9.wav",
        "zcitysnd/player/footsteps/wood10.wav",
        "zcitysnd/player/footsteps/wood11.wav"
    },
    wood_panel = {
        "zcitysnd/player/footsteps/woodpanel1.wav",
        "zcitysnd/player/footsteps/woodpanel2.wav",
        "zcitysnd/player/footsteps/woodpanel3.wav",
        "zcitysnd/player/footsteps/woodpanel4.wav",
        "zcitysnd/player/footsteps/woodpanel5.wav",
        "zcitysnd/player/footsteps/woodpanel6.wav",
        "zcitysnd/player/footsteps/woodpanel7.wav",
        "zcitysnd/player/footsteps/woodpanel8.wav",
        "zcitysnd/player/footsteps/woodpanel9.wav",
        "zcitysnd/player/footsteps/woodpanel10.wav",
        "zcitysnd/player/footsteps/woodpanel11.wav"
    },
    concrete = {
        "zcitysnd/player/footsteps/concrete1.wav",
        "zcitysnd/player/footsteps/concrete2.wav",
        "zcitysnd/player/footsteps/concrete3.wav",
        "zcitysnd/player/footsteps/concrete4.wav",
        "zcitysnd/player/footsteps/concrete5.wav",
        "zcitysnd/player/footsteps/concrete6.wav",
        "zcitysnd/player/footsteps/concrete7.wav",
        "zcitysnd/player/footsteps/concrete8.wav",
        "zcitysnd/player/footsteps/concrete9.wav",
        "zcitysnd/player/footsteps/concrete10.wav",
        "zcitysnd/player/footsteps/concrete11.wav"
    }, 
    land = {
        "homigrad/player/land.wav",
        "homigrad/player/land2.wav",
        "homigrad/player/land3.wav",
        "homigrad/player/land4.wav"
    },
    default = {
        "zcitysnd/player/footsteps/concrete1.wav",
        "zcitysnd/player/footsteps/concrete2.wav",
        "zcitysnd/player/footsteps/concrete3.wav",
        "zcitysnd/player/footsteps/concrete4.wav",
        "zcitysnd/player/footsteps/concrete5.wav",
        "zcitysnd/player/footsteps/concrete6.wav",
        "zcitysnd/player/footsteps/concrete7.wav",
        "zcitysnd/player/footsteps/concrete8.wav",
        "zcitysnd/player/footsteps/concrete9.wav",
        "zcitysnd/player/footsteps/concrete10.wav",
        "zcitysnd/player/footsteps/concrete11.wav"
    }
}

if CLIENT then
    local hg_camshake_amount = CreateClientConVar("hg_camshake_amount", "1", true, false, nil, 0, 1.5)
    local hg_camshake_enabled = CreateClientConVar("hg_camshake_enabled", "1", true, false, nil, 0, 1)

    hook.Add("PlayerFootstep", "Homigrad_Step", function(ply, pos, f, snd, v)
        local tr = util.TraceLine({
            start = pos + vector_up * 10,
            endpos = pos + vector_up * -100,
            filter = {ply}
        })

        if !ply.lastfoot then
            ply.lastfoot = CurTime() + 0.3
        end

        if ply.lastfoot > CurTime() then
            return true
        end

        ply.lastfoot = CurTime() + (ply:IsSprinting() and 0.2 or 0.4)

        local mat = util.GetSurfacePropName(tr.SurfaceProps)

        if mat == "default" then
            -- return true
        end

        if ply:IsSprinting() and ply:GetVelocity():Length() > 115 and ply == LocalPlayer() then
            Viewpunch(Angle(0.5,0,0))
        end

        if GetConVar("developer"):GetBool() then
            print(mat)
        end

        if !hg.FootSteps[mat] then
            mat = "default"
        end

        snd = table.Random(hg.FootSteps[mat])

        if ply.armor and ply.armor.torso != "NoArmor" then
            sound.Play(Sound("snd_jack_gear" .. math.random(1, 6) .. ".wav"), pos, 100, 100, 0.5)
        end

        if ply:GetNWBool("IsCombine") then
            sound.Play(Sound("npc/combine_soldier/gear" .. math.random(1, 6) .. ".wav"), pos, 75, 100, v * 1.4)
        end

        sound.Play(snd, pos, 80, math.random(90, 100), v * 1.4)

        return true
    end)
else
    hook.Add("OnPlayerHitGround", "Homigrad_Step", function(ply, inwater, float, speed)
        local snd = table.Random(hg.FootSteps.land)
    
        ply:EmitSound(snd, 70, math.random(95, 100), 0.4, CHAN_BODY, SND_CHANGE_PITCH)
    end)
end